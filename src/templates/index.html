{% extends "layouts/base.html" %}

{% block title %} Dashboard {% endblock %} 

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}
<div class="content">
  <div class="row">
    {% if sentiment_summary %}
    <div class="container-fluid">
      <div class="row">
        <div class="col-12">
          <div class="card mb-4">
            <div class="card-body">
              <h4>Crypto: {{ crypto_id }}</h4>
                <ul>
                  <li><strong>Average Sentiment Score:</strong> {{ sentiment_summary.average_score }}</li>
                  <li class="text-success"><strong>Positive Posts:</strong> {{ sentiment_summary.positive }}</li>
                  <li class="text-secondary"><strong>Neutral Posts:</strong> {{ sentiment_summary.neutral }}</li>
                  <li class="text-danger"><strong>Negative Posts:</strong> {{ sentiment_summary.negative }}</li>
                </ul>

                <h5 class="card-title text-success mt-3">Most Positive Post</h5>
                <p>{{ sentiment_summary.most_positive.Text }}</p>
                <small class="text-muted">Score: {{ sentiment_summary.most_positive.SentimentScore }}</small>

                <h5 class="card-title text-danger mt-3">Most Negative Post</h5>
                <p>{{ sentiment_summary.most_negative.Text }}</p>
                <small class="text-muted">Score: {{ sentiment_summary.most_negative.SentimentScore }}</small>


            </div>
          </div>
        </div>
      </div>
    </div>
    {% endif %}


  </div>
  <div class="row">
    <div class="col-12">
      <div class="card card-chart">
        <div class="card-header">
          <div class="row">
            <div class="col-sm-6 text-left">
              <h5 class="card-category">Average Sentiment Over Time</h5>
              <h2 class="card-title">Crypto News Sentiment</h2>
            </div>
          </div>
        </div>
        <div class="card-body">
          <div class="chart-area text-center" style="height: auto; overflow: visible;">
            {% if chart_filename %}
              <!-- Existing average sentiment chart -->
              <img src="{{ url_for('static', filename=chart_filename) }}" alt="Sentiment Chart" class="img-fluid" style="max-width: 100%; height: auto;">
            {% else %}
              <p class="text-muted">No chart available. Select a Crypto subject to view sentiment.</p>
            {% endif %}
          </div>

          <hr>

          <div class="chart-area text-center" style="height: auto; overflow: visible;">
            {% if area_chart_filename %}
              <!-- New chart for positive/neutral/negative counts -->
              <h5 class="card-category mt-3">Pos/Neu/Neg Over Time</h5>
              <img src="{{ url_for('static', filename=area_chart_filename) }}" alt="POS/NEG/NEU Chart" class="img-fluid" style="max-width: 100%; height: auto;">
            {% else %}
              <p class="text-muted">No POS/NEG/NEU chart available.</p>
            {% endif %}

          </div>
        </div>

      </div>
    </div>
  </div>
  <div class="card-body">
  <table class="table tablesorter">
    <thead class="text-primary">
      <tr>
        <th>Date</th>
        <th>Sentiment Score</th>
        <th>Article</th>
        <th>Source</th>
      </tr>
    </thead>
    <tbody>
      {% for article in articles %}
      <tr>
        <td>{{ article.date }}</td>
        <td>{{ article.SentimentScore }}</td>
        <td>
          <a href="/article/{{ article.url | urlencode }}">
            {{ article.text }}
          </a>
        </td>
        <td>{{ article.source }}</td>
      </tr>
      {% endfor %}
    </tbody>
</table>

</div>

  <!-- <div class="card-body">
  {% if reviews|length > 0 %}
  <div class="table-responsive">
    <table class="table tablesorter">
      <thead class="text-primary">
        <tr>
          <th>User</th>
          <th>Sentiment Score</th>
          <th>Review</th>
        </tr>
      </thead>
      <tbody>
        {% for review in reviews %}
        <tr>
          <td>
            <a href="/user_reviews/{{ review.ProfileName }}" class="text-decoration-none">
              {{ review.ProfileName }}
            </a>
          </td>
          <td>{{ review.SentimentScore }}</td>
          <td>{{ review.Text }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <p class="text-muted">No reviews available.</p>
  {% endif %}
</div> -->


  
</div>
{% endblock content %}
